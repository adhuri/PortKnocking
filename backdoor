<<<<<<< HEAD
#!/usr/bin/env python2.7
import sys
import socket
import struct

def readConfig(configuration_file = "configuration-file"):
	portlist = []
	try:
		with open(configuration_file, 'r') as f:
    			portlist = [line.strip() for line in f]
	except:
		print "Error reading config file named configuration-file \n Exiting .."
		sys.exit()
	return portlist



def run(portlist):


	def parsePacket(packet):
		
		#Parse IP packet and look for TCP SYN return tuple (host,port)
		
		#Packet Data
		data = packet[0]
		
		#IP Header
		IPHeader = data[:20]
		
	


		port = 8766
		return (packet[1][0],port)	

	

	try:
		s = socket.socket(socket.AF_INET, socket.SOCK_RAW, socket.IPPROTO_TCP)

	except socket.error , msg:
    		print 'Socket could not be created.\nError Code : ' + str(msg[0]) + '\nMessage ' + msg[1]
    		sys.exit()
	while True:
		packet = s.recvfrom(65565)
		
		host_port =  parsePacket(packet)
		
		if host_port:
			print host_port
	

if __name__ == "__main__":
	portlist =  readConfig()
	run(portlist)







=======
>>>>>>> parent of ec955db... Added backdoor simple functionality to sniff packets
